{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dtzr/Documents/GitHub/birdex-redux/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dtzr/Documents/GitHub/birdex-redux/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dtzr/Documents/GitHub/birdex-redux/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import Nav from'../components/Navbar/Nav';import{Icon,Menu,Table,Button,Modal,Input,Dropdown}from'semantic-ui-react';import'./EntriesPageStyles.css';import{useHistory}from'react-router';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EntriesPage(_ref){var match=_ref.match;var data=match.params;var ts=new Date();var history=useHistory();//State of modal that adds new entry\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),weightinput=_useState4[0],setWeight=_useState4[1];var currentDate=ts.toLocaleDateString(\"en-US\")+' '+ts.toLocaleTimeString(\"en-US\");//State of modal that updates entry\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),open2=_useState6[0],setOpen2=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),newWeight=_useState8[0],setnewWeight=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),editId=_useState10[0],seteditId=_useState10[1];//Server to add new entries\nvar newEntries=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(weightinput<=0){alert(\"Incorrect Weight Value!\");setWeight(0);}else{//create entry\n}case 1:case\"end\":return _context.stop();}}},_callee);}));return function newEntries(_x){return _ref2.apply(this,arguments);};}();var sendEntry=function sendEntry(){setOpen(false);newEntries();};//Server to render entries\nvar _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),entry=_useState12[0],setEntry=_useState12[1];var getbirdEntries=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,jsonData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"/birds/\".concat(data.birdName,\"/\").concat(data.birdsid,\"/\").concat(data.species_name,\"/entries\"));case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:jsonData=_context2.sent;setEntry(jsonData);_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0.message);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function getbirdEntries(){return _ref3.apply(this,arguments);};}();useEffect(function(){getbirdEntries();},[]);console.log(entry);//Server to delete entry\n//Only allow to delete if there is more than one entry --> so there must be at least an entry in every bird\nvar deletebird=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var _deletebird;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"/birds/\".concat(data.birdName,\"/\").concat(data.birdsid,\"/\").concat(data.species_name,\"/entries\"),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({\"entry_id\":id})});case 3:_deletebird=_context3.sent;window.location.reload();_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0.message);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function deletebird(_x2){return _ref4.apply(this,arguments);};}();var handleDelete=function handleDelete(id){if(entry.length>1){deletebird(id);}else{alert(\"You need to keep at least one entry!\");}};//Server to update entry\nvar handleUpdate=function handleUpdate(id){setOpen2(!open2);seteditId(id);/* In order to make the current id that we clicked a global variable */};var onUpdate=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return fetch(\"/birds/\".concat(data.birdName,\"/\").concat(data.birdsid,\"/\").concat(data.species_name,\"/entries\"),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({\"id\":editId,\"weight\":newWeight,\"created_at\":currentDate})});case 3:response=_context4.sent;_context4.next=9;break;case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](0);console.error(_context4.t0.message);case 9:case\"end\":return _context4.stop();}}},_callee4,null,[[0,6]]);}));return function onUpdate(){return _ref5.apply(this,arguments);};}();var setUpdate=function setUpdate(){onUpdate();history.push('/');};console.log(entry);//DISPLAYING ALL ENTRIES JSX\nvar entries=entry.map(function(details){return/*#__PURE__*/_jsx(Table.Body,{style:{textAlign:\"center\"},children:/*#__PURE__*/_jsxs(Table.Row,{className:\"EntriesTableRow\",children:[/*#__PURE__*/_jsx(Table.Cell,{children:details.created_at}),/*#__PURE__*/_jsx(Table.Cell,{children:details.weight}),/*#__PURE__*/_jsx(Table.Cell,{children:/*#__PURE__*/_jsx(Icon,{className:\"edit-button\",name:\"edit\",size:\"big\",onClick:function onClick(){return handleUpdate(details.entry_id);}})}),/*#__PURE__*/_jsx(Table.Cell,{children:/*#__PURE__*/_jsx(Icon,{className:\"delete-button\",name:\"delete\",size:\"big\",color:\"red\",onClick:function onClick(){return handleDelete(details.entry_id);}})})]})},details.entry_id);});//For the input field for weight\nvar options=[{key:'integer',text:'integer',value:'integer'},{key:'decimals',text:'decimals',value:'decimals'}];return/*#__PURE__*/_jsxs(\"div\",{className:\"EntriesContainer\",children:[/*#__PURE__*/_jsx(Nav,{}),/*#__PURE__*/_jsxs(Table,{celled:true,className:\"EntriesTable\",children:[/*#__PURE__*/_jsx(Table.Header,{children:/*#__PURE__*/_jsxs(Table.Row,{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"TimeStamp\"}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"Weight\"}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"Edit\"}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"Delete\"})]})}),entries,/*#__PURE__*/_jsx(Table.Footer,{children:/*#__PURE__*/_jsx(Table.Row,{children:/*#__PURE__*/_jsx(Table.HeaderCell,{colSpan:\"4\",children:/*#__PURE__*/_jsxs(Menu,{floated:\"right\",pagination:true,children:[/*#__PURE__*/_jsx(Menu.Item,{as:\"a\",icon:true,children:/*#__PURE__*/_jsx(Icon,{name:\"chevron left\"})}),/*#__PURE__*/_jsx(Menu.Item,{as:\"a\",children:\"1\"}),/*#__PURE__*/_jsx(Menu.Item,{as:\"a\",children:\"2\"}),/*#__PURE__*/_jsx(Menu.Item,{as:\"a\",children:\"3\"}),/*#__PURE__*/_jsx(Menu.Item,{as:\"a\",children:\"4\"}),/*#__PURE__*/_jsx(Menu.Item,{as:\"a\",icon:true,children:/*#__PURE__*/_jsx(Icon,{name:\"chevron right\"})})]})})})})]}),/*#__PURE__*/_jsxs(Modal,{size:'tiny',onClose:function onClose(){return setOpen(false);},onOpen:function onOpen(){return setOpen(true);},open:open,trigger:/*#__PURE__*/_jsx(Button,{className:\"showmodal--button\",children:\"Add New Entry\"}),children:[/*#__PURE__*/_jsx(Modal.Header,{children:\"Add New Entry\"}),/*#__PURE__*/_jsx(Modal.Content,{children:/*#__PURE__*/_jsx(Modal.Description,{children:/*#__PURE__*/_jsx(Input,{label:/*#__PURE__*/_jsx(Dropdown,{defaultValue:\"int\",options:options}),labelPosition:\"right\",placeholder:\"Enter weight\",value:weightinput,onChange:function onChange(e){return setWeight(e.target.value);}})})}),/*#__PURE__*/_jsx(Modal.Actions,{children:/*#__PURE__*/_jsx(Button,{content:\"Add\",labelPosition:\"right\",icon:\"checkmark\",onClick:sendEntry,positive:true})})]}),/*#__PURE__*/_jsxs(Modal,{size:'tiny',onClose:function onClose(){return setOpen2(false);},onOpen:function onOpen(){return setOpen2(true);},open:open2,children:[/*#__PURE__*/_jsx(Modal.Header,{children:\" Edit Entry\"}),/*#__PURE__*/_jsx(Modal.Content,{children:/*#__PURE__*/_jsx(Modal.Description,{children:/*#__PURE__*/_jsx(Input,{label:/*#__PURE__*/_jsx(Dropdown,{defaultValue:\"int\",options:options}),labelPosition:\"right\",placeholder:\"Enter weight\",value:newWeight,onChange:function onChange(e){return setnewWeight(e.target.value);}})})}),/*#__PURE__*/_jsx(Modal.Actions,{children:/*#__PURE__*/_jsx(Button,{content:\"Add\",labelPosition:\"right\",icon:\"checkmark\",onClick:setUpdate,positive:true})})]}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return history.goBack();},content:\"Back\",icon:\"left arrow\",labelPosition:\"left\"})]});}export default EntriesPage;","map":{"version":3,"sources":["/Users/dtzr/Documents/GitHub/birdex-redux/src/pages/EntriesPage.js"],"names":["React","useEffect","useState","Nav","Icon","Menu","Table","Button","Modal","Input","Dropdown","useHistory","EntriesPage","match","data","params","ts","Date","history","open","setOpen","weightinput","setWeight","currentDate","toLocaleDateString","toLocaleTimeString","open2","setOpen2","newWeight","setnewWeight","editId","seteditId","newEntries","e","alert","sendEntry","entry","setEntry","getbirdEntries","fetch","birdName","birdsid","species_name","response","json","jsonData","console","log","message","deletebird","id","method","headers","body","JSON","stringify","window","location","reload","handleDelete","length","handleUpdate","onUpdate","error","setUpdate","push","entries","map","details","textAlign","created_at","weight","entry_id","options","key","text","value","target","goBack"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport Nav from '../components/Navbar/Nav'\nimport { Icon, Menu, Table, Button, Modal, Input, Dropdown  } from 'semantic-ui-react'\nimport './EntriesPageStyles.css'\nimport { useHistory } from 'react-router'\n\n\nfunction EntriesPage({match}) {\n\n  const data = match.params\n  const ts = new Date();\n  const history = useHistory()\n\n  //State of modal that adds new entry\n  const [open, setOpen] = useState(false) \n  const [weightinput, setWeight] = useState(0);\n  const currentDate = ts.toLocaleDateString(\"en-US\") + ' ' + ts.toLocaleTimeString(\"en-US\")\n  \n  //State of modal that updates entry\n  const [open2, setOpen2] = useState(false)\n  const [newWeight, setnewWeight] = useState('')\n  const [editId, seteditId] = useState(\"\")\n\n  //Server to add new entries\n  const newEntries = async e => {\n    if (weightinput <= 0){\n      alert(\"Incorrect Weight Value!\")\n      setWeight(0)\n    } else {\n        //create entry\n      }\n    }\n\n    const sendEntry = () => {\n      setOpen(false)\n      newEntries()\n    }\n\n  //Server to render entries\n  const [entry, setEntry] = useState([])\n\n  const getbirdEntries = async() => {\n    try {\n      const response = await fetch(`/birds/${data.birdName}/${data.birdsid}/${data.species_name}/entries`)\n      const jsonData = await response.json()\n\n      setEntry(jsonData)\n    } catch (err) {\n      console.log(err.message)\n    }\n  }\n\n  useEffect(() => {\n      getbirdEntries()\n  },[])\n\n  console.log(entry)\n\n  //Server to delete entry\n  //Only allow to delete if there is more than one entry --> so there must be at least an entry in every bird\n  const deletebird = async(id) => {\n    try {\n      const deletebird = await fetch(`/birds/${data.birdName}/${data.birdsid}/${data.species_name}/entries`,{\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          \"entry_id\": id\n        })\n      })\n      window.location.reload();\n    } catch (err) {\n      console.log(err.message)\n    }\n  }\n\n  const handleDelete = (id) => {\n    if(entry.length > 1){\n      deletebird(id)\n    }else{\n      alert(\"You need to keep at least one entry!\")\n    }\n  }\n\n  //Server to update entry\n  const handleUpdate = (id) => {\n    setOpen2(!open2)\n    seteditId(id) /* In order to make the current id that we clicked a global variable */\n  }\n\n  const onUpdate = async() => {\n    try {\n      const response = await fetch(`/birds/${data.birdName}/${data.birdsid}/${data.species_name}/entries`,\n        {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            \"id\": editId,\n            \"weight\": newWeight,\n            \"created_at\": currentDate,\n          })\n        }\n      )\n    } catch (err) {\n      console.error(err.message);\n    }\n  };\n  \n  const setUpdate = () => {\n    onUpdate();\n    history.push('/')\n  }\n\n  console.log(entry)\n  //DISPLAYING ALL ENTRIES JSX\n  const entries = entry.map(details => {\n    return (\n    <Table.Body key={details.entry_id} style={{textAlign: \"center\" }}>\n        <Table.Row className =\"EntriesTableRow\">\n        <Table.Cell >{(details.created_at)}</Table.Cell>\n        <Table.Cell>{details.weight}</Table.Cell> \n        <Table.Cell><Icon className=\"edit-button\" name='edit' size='big' onClick={()=>handleUpdate(details.entry_id)}/></Table.Cell> \n        <Table.Cell><Icon className=\"delete-button\" name='delete' size='big' color=\"red\" onClick = {()=> handleDelete(details.entry_id)}/></Table.Cell> \n        </Table.Row>\n    </Table.Body>\n  )})\n\n  //For the input field for weight\n  const options = [\n    { key: 'integer', text: 'integer', value: 'integer' },\n    { key: 'decimals', text: 'decimals', value: 'decimals' },\n  ]\n\n  return (\n    <div className = \"EntriesContainer\">\n      <Nav/>\n        <Table celled className=\"EntriesTable\">\n          <Table.Header>\n            <Table.Row style={{textAlign: \"center\"}}> \n              <Table.HeaderCell>TimeStamp</Table.HeaderCell>\n              <Table.HeaderCell>Weight</Table.HeaderCell>\n              <Table.HeaderCell>Edit</Table.HeaderCell>\n              <Table.HeaderCell>Delete</Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n          {entries}\n          <Table.Footer>\n            <Table.Row>\n              <Table.HeaderCell colSpan='4'>\n                  <Menu floated='right' pagination>\n                  <Menu.Item as='a' icon>\n                    <Icon name='chevron left' />\n                  </Menu.Item>\n                  <Menu.Item as='a'>1</Menu.Item>\n                  <Menu.Item as='a'>2</Menu.Item>\n                  <Menu.Item as='a'>3</Menu.Item>\n                  <Menu.Item as='a'>4</Menu.Item>\n                  <Menu.Item as='a' icon>\n                    <Icon name='chevron right' />\n                  </Menu.Item>\n                </Menu>\n              </Table.HeaderCell>\n            </Table.Row>\n          </Table.Footer>\n        </Table>\n\n        {/* Modal To Add New Entry*/}\n        <Modal\n          size={'tiny'}\n          onClose={() => setOpen(false)}\n          onOpen={() => setOpen(true)}\n          open={open}\n          trigger={<Button className=\"showmodal--button\">Add New Entry</Button>}\n        >\n        <Modal.Header>Add New Entry</Modal.Header>\n        <Modal.Content>\n          <Modal.Description>\n          <Input\n            label={<Dropdown defaultValue='int' options={options} />}\n            labelPosition='right'\n            placeholder='Enter weight'\n            value={weightinput}\n            onChange={e => setWeight(e.target.value)}\n          />\n          </Modal.Description>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button\n            content=\"Add\"\n            labelPosition='right'\n            icon='checkmark'\n            onClick={sendEntry}\n            positive\n          />\n        </Modal.Actions>\n      </Modal>\n\n      {/* Modal To Update Entry */}\n      <Modal\n          size={'tiny'}\n          onClose={() => setOpen2(false)}\n          onOpen={() => setOpen2(true)}\n          open={open2}\n      >\n        <Modal.Header> Edit Entry</Modal.Header>\n        <Modal.Content>\n          <Modal.Description>\n          <Input\n            label={<Dropdown defaultValue='int' options={options} />}\n            labelPosition='right'\n            placeholder='Enter weight'\n            value={newWeight}\n            onChange={e => setnewWeight(e.target.value)}\n          />\n          </Modal.Description>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button\n            content=\"Add\"\n            labelPosition='right'\n            icon='checkmark'\n            onClick={setUpdate}\n            positive\n          />\n        </Modal.Actions>\n      </Modal>\n\n      <Button onClick={()=>history.goBack()} content='Back' icon='left arrow' labelPosition='left' />\n\n    </div>\n  )\n}\n\nexport default EntriesPage\n"]},"metadata":{},"sourceType":"module"}